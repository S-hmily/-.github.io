<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>å®å®å½“</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="å®å½“"/>
<meta name="keywords" content="å®å½“"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://s-hmily.github.io/favicon.ico">

<link rel="stylesheet" href="https://s-hmily.github.io/styles/main.css">

<!-- Modernizr JS -->
<script src="https://s-hmily.github.io/media/scripts/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://s-hmily.github.io/media/scripts/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->



<!-- katex -->
<!--<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet">-->

<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">



</head>
<body>
    <div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://s-hmily.github.io/images/avatar.png" alt="å®å®å½“"
                 class="img-responsive">
        </figure>
        <a href="https://s-hmily.github.io/post/about/"><h3 class="heading">ABOUT ME</h3></a>
        <h2>å®å®å½“</h2>
        <p>å®å½“</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">

        <!-- æ ‡ç­¾ -->
        <div class="fh5co-box">
            <a href="https://s-hmily.github.io/tags/"><h3 class="heading">ğŸ‘‰æ ‡ç­¾</h3></a>
            <ul>
                
                    <li><a href="https://s-hmily.github.io/tag/lMYeCI_cf/">æœºå™¨å­¦ä¹ </a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="https://s-hmily.github.io"
                        
                        >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                        
                        >
                            å½’æ¡£
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://s-hmily.github.io">å®å®å½“ </a>
                </h1>
            </div>
        </div>
    </div>
</header>


    <!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
    <!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

    <!-- ç­‰grideaå‡ºè‡ªå®šä¹‰é¡µé¢åŠŸèƒ½å†ä¼˜åŒ–ä¸€ä¸‹ -->
    
        <div class="container-fluid">
    <div class="row fh5co-post-entry single-entry">
        <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
            <figure class="animate-box">
                
                    <img src="https://s-hmily.github.io/post-images/ji-yu-ju-zhen-fen-jie-de-tui-jian-suan-fa.JPG" alt="åŸºäºçŸ©é˜µåˆ†è§£çš„æ¨èç®—æ³•" class="img-responsive">
                
            </figure>
            <span class="fh5co-meta animate-box">
                
                    <div class="tag-container">
                        
                            <a href="https://s-hmily.github.io/tag/lMYeCI_cf/" class="tag">æœºå™¨å­¦ä¹ , </a>
                        
                    </div>
                
            </span>
            <h2 class="fh5co-article-title animate-box">åŸºäºçŸ©é˜µåˆ†è§£çš„æ¨èç®—æ³•</h2>
            <ol class="breadcrumb fh5co-meta fh5co-date animate-box" style="margin-bottom:0; background-color:#f8f9fa">
                <li>2020-07-14</li>
                <li>1057å­—</li>
                <li>5 min read</li>
            </ol>

            <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                <div class="row">
                    <div class="col-md-12 animate-box post-content">
                        <p> <p><img src="https://s-hmily.github.io/post-images/1594775275815.JPG" alt="" loading="lazy"><br>
çŸ©é˜µåˆ†è§£ç®—æ³•æ˜¯å­¦ä¹ ååŒè¿‡æ»¤ç®—æ³•çš„åŸºç¡€ï¼Œæ¥ä¸‹æ¥å°±æ¥è®²ä¸€ä»¶ä»€ä¹ˆæ˜¯çŸ©é˜µåˆ†è§£ã€‚<br>
ä¸€ï¼ŒåŸºäºçŸ©é˜µåˆ†è§£ç®—æ³•çš„ç›¸å…³ç†è®ºä»‹ç»<br>
å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦æ˜¯æƒ³åšæ¨èç³»ç»Ÿï¼Œæœ€åŸºæœ¬çš„ä¸€ä¸ªæ•°æ®å°±æ˜¯ç”¨æˆ·å¯¹è¿™ä¸ªå•†å“çš„ç‰¹æ€§çš„ååº”ï¼Œå°±æ‹¿ç”¨æˆ·-ç‰©å“çš„è¯„åˆ†çŸ©é˜µæ¥è¯´<br>
<img src="https://img-blog.csdnimg.cn/20200713205030760.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MTc3OTYw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
çŸ©é˜µä¸­ï¼Œæè¿°äº†äº”ä¸ªç”¨æˆ·ï¼ˆU1,U2,U3,U4,U5ï¼‰å¯¹å››ä¸ªç‰©å“ï¼ˆD1,D2,D3,D4ï¼‰çš„è¯„åˆ†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æœ‰äº›è¡¨æ ¼ä¸­æ²¡æœ‰å¡«å†™è¯„åˆ†<br>
çš„æ•°å­—ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æŠŠæ²¡æœ‰å¡«å†™çš„è¯„åˆ†æ ¹æ®å·²çŸ¥çš„åˆ†æ•°è¿›è¡Œé¢„æµ‹ï¼Œç„¶åæ ¹æ®è¯„åˆ†çš„é«˜ä½ç»™ç”¨æˆ·è¿›è¡Œæ¨èã€‚<br>
é‚£ä¹ˆå¦‚ä½•è¿›è¡Œé¢„æµ‹ç¼ºå¤±çš„è¯„åˆ†å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›æƒ³è±¡æˆç‚¹ï¼Œç„¶åå¯ä»¥æ ¹æ®æ¢¯åº¦ä¸‹é™è·Ÿå›å½’æ–¹ç¨‹è¿›è¡Œè¿ç»­å€¼çš„é¢„æµ‹ã€‚å‡è®¾æ˜¯M<em>Nç»´çŸ©é˜µï¼ˆMè¡ŒNåˆ—ï¼‰ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åˆ†è§£æˆPçŸ©é˜µå’ŒQçŸ©é˜µï¼Œå…¶ä¸­PçŸ©é˜µæ˜¯M</em>K,QçŸ©é˜µç»´åº¦æ˜¯K*Nã€‚ï¼ˆKæ˜¯è¿‡æ¸¡æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯è¿‡æ¸¡ç»´åº¦ï¼‰<br>
<img src="https://img-blog.csdnimg.cn/20200713210022150.png" alt="å›¾ä¸€" loading="lazy"><br>
å¯¹äºP,QçŸ©é˜µçš„è§£é‡Šï¼Œç›´è§‚ä¸Šæ˜¯Mä¸ªç”¨æˆ·å¯¹Kä¸ªä¸»é¢˜çš„å…³ç³»ï¼ŒQçŸ©é˜µæ˜¯Kä¸ªä¸»é¢˜å¯¹Nä¸ªç‰©å“çš„å…³ç³»ï¼Œå…·ä½“Kæ˜¯å¤šå°‘ï¼Œè¿™å°±éœ€è¦è‡ªå·±çš„è°ƒèŠ‚äº†ï¼ŒKåªæ˜¯ä¸€ä¸ªå‚æ•°ï¼Œé€šå¸¸å–å€¼åœ¨10åˆ°100ä¹‹é—´<br>
<img src="https://img-blog.csdnimg.cn/2020071321100480.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
å¼å­2</p>
<p>å…¶ä¸­rä»£è¡¨ RåŸå§‹çŸ©é˜µï¼Œpï¼Œqä»£è¡¨P,QçŸ©é˜µã€‚rijä»£è¡¨RçŸ©é˜µç¬¬iè¡Œç¬¬jåˆ—çš„æ•°å­—ï¼Œåè¾¹çš„åŒç†<br>
æˆ‘ä»¬å¯¹äºçŸ©é˜µçš„çŸ¥è¯†å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªçŸ©é˜µiè¡Œjåˆ—çš„æ•°å€¼ç­‰äºPçŸ©é˜µiè¡Œçš„æ‰€æœ‰æ•°å€¼ä¹˜ä»¥qç¬¬jåˆ—çš„æ‰€æœ‰æ•°å€¼çš„å’Œ<br>
ç„¶åæˆ‘ä»¬å¯ä»¥çŸ¥é“å›å½’æ–¹ç¨‹çš„æœ€å°äºŒä¹˜æ³•çš„å…¬å¼å¦‚ä¸‹<br>
ç„¶åæŠŠå¼å­2å¸¦å…¥å¼å­3ä¸­å¾—åˆ°ä¸‹å›¾<br>
<img src="https://img-blog.csdnimg.cn/20200713210437802.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
å¼å­3</p>
<p>å¯¹äºæŸå¤±å‡½æ•°çš„å·¦è¾¹é¡¹ï¼Œè¡¨ç¤ºçš„æ˜¯R^ ç¬¬iè¡Œï¼Œç¬¬jåˆ—çš„å…ƒç´ å€¼ï¼Œå¯¹äºå¦‚ä½•è¡¡é‡ï¼Œæˆ‘ä»¬åˆ†è§£çš„å¥½åå‘¢ï¼Œå¼å­3ï¼Œç»™å‡ºäº†è¡¡é‡æ ‡å‡†ï¼Œä¹Ÿå°±æ˜¯æŸå¤±å‡½æ•°ï¼Œå¹³æ–¹é¡¹æŸå¤±ï¼Œæœ€åçš„ç›®æ ‡ï¼Œå°±æ˜¯æ¯ä¸€ä¸ªå…ƒç´ (éç¼ºå¤±å€¼)çš„e(i,j)çš„æ€»å’Œæœ€å°<br>
ç„¶åæˆ‘ä»¬éœ€è¦ç”¨åˆ°L2æ­£åˆ™åŒ–<br>
<img src="https://img-blog.csdnimg.cn/20200713211252210.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
å› æ­¤æœ€ç»ˆçš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>
<img src="https://img-blog.csdnimg.cn/20200713211530742.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
ç„¶åå¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•å¯¹å…¶æ±‚è§£PçŸ©é˜µå’ŒQçŸ©é˜µ<img src="https://img-blog.csdnimg.cn/20200713211609666.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
æœ€åç»“æœä¸ºï¼š<br>
<img src="https://img-blog.csdnimg.cn/20200713211625329.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>
ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-cpp">
import numpy as np

#  original_matrix --&gt; P*Q=R
def matrix_factorization(original_matrix, K, alpha, beta, epochs):
    '''
    :param original_matrix(mat): åŸå§‹çŸ©é˜µ
    :param K(int): åˆ†è§£çŸ©é˜µä¸­é—´ç»´åº¦
    :param alpha(float): å­¦ä¹ ç‡
    :param beta(float): æƒ©ç½šæ€§ç³»æ•°
    :param epochs(int): æœ€å¤§è¿­ä»£æ¬¡æ•°
    :return: åˆ†è§£åçš„ä¸¤ä¸ªçŸ©é˜µP,Q
    '''
    original_matrix = np.mat(original_matrix)
    #np.mat ç”ŸæˆçŸ©é˜µ
    M, N = original_matrix.shape
    #np.shape è·å–çŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œç„¶åèµ‹å€¼ç»™M,N  å³Mä»£è¡¨è¡Œæ•° Nä»£è¡¨åˆ—æ•°
    P = np.mat(np.random.random((M, K)))
    Q = np.mat(np.random.random((K, N)))
    #np.random.random((M,K))  ç”ŸæˆMè¡ŒKåˆ—çš„æµ®ç‚¹æ•° ï¼Œæ­é…ä¸Šmat ä¹Ÿå°±æ˜¯ç”ŸæˆçŸ©é˜µ
    print(&quot;.................&quot;)
    print(P,Q)
    print(&quot;.................&quot;)
    loss = 1.0
    epoch = 0
    while loss &gt;= 0.001 and epoch &lt;= epochs:
        for m in range(M):
            for n in range(N):
                if original_matrix[m, n] &gt; 0:  # éç¼ºå¤±å€¼
                    r = original_matrix[m, n]
                    r_ = 0  # R[m, n]
                    for k in range(K):  # è®¡ç®—[m, n]ä½ç½®çš„è¯¯å·®
                        r_ += P[m, k]*Q[k, n]
                    e = r - r_
                    for k in range(K):  # æ›´æ–°P[m, :]ä¸Q[:, n]çš„å€¼
                        P[m, k] += alpha*(2*e*Q[k, n]-beta*P[m, k])
                        Q[k, n] += alpha*(2*e*P[m, k]-beta*Q[k, n])
        loss = 0.0
        for m in range(M):
            for n in range(N):
                if original_matrix[m, n] &gt; 0:
                    r = original_matrix[m, n]
                    r_ = 0.0
                    regularization = 0.0
                    for k in range(K):
                        r_ += P[m, k]*Q[k, n]  # åå·®
                        regularization += P[m, k]**2+Q[k, n]**2  # L2æ­£åˆ™åŒ–
                    e = r - r_
                    loss += e**2 + (beta/2)*regularization  # æ€»æŸå¤±
        # if epoch % 200 == 0:
        #     print('epoch:{}, loss: {}'.format(epoch, loss))
        epoch += 1
    return P, Q


if __name__ == '__main__':
    low, high = 1, 10
    size = 10, 8
    original_matrix = np.random.randint(low=low, high=high, size=size)
    missing_rate = 0.3
    n_counts = int(size[0]*size[1]*missing_rate)
    while n_counts:
        pos = np.random.randint(size[0]*size[1])
        row, col = pos//size[1], pos%size[1]
        if original_matrix[row, col] != 0:
            original_matrix[row, col] = 0
            n_counts -= 1
    # print(original_matrix)
    P, Q = matrix_factorization(original_matrix, 6, 0.004, 0.02, 12000)
    print(np.dot(P, Q))
</code></pre>
<p>å‚è€ƒï¼š<br>
<a href="https://blog.csdn.net/recall_tomorrow/article/details/80218051">æ–‡ç« ä¸€</a><br>
<a href="https://www.cnblogs.com/kobedeshow/p/3651833.html">æ–‡ç« äºŒ</a></p>
 </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 animate-box">
                        
                            <div class="next-post">
                                <div class="next">ä¸‹ä¸€ç¯‡</div>
                                <a href="https://s-hmily.github.io/post/ji-yu-yong-hu-de-xie-tong-guo-lu-suan-fa/">
                                    <h3 class="post-title">
                                        åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•
                                    </h3>
                                </a>
                            </div>
                        
                    </div>
                </div>

                <div class="row">
    <div class="col-md-12 animate-box">
        
    </div>
</div>

            </div>

        </article>
    </div>
</div>

    

    <!-- è¿”å›é¡¶éƒ¨ -->
    <div class="back-to-top">
    
    <a href="#top" class="hidden-xs hidden-sm"><i class="fa fa-paper-plane"></i></a>
</div>

<div class="post-toc animated fadeInRight hidden-xs hidden-sm" style="display: none;">
    
</div>


    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a></p>
</footer>


    <!-- jQuery -->
<script src="https://s-hmily.github.io/media/scripts/jquery.min.js"></script>
<!-- img lazy load -->
<script src="https://s-hmily.github.io/media/scripts/jquery.lazyload.min.js"></script>
<!-- jQuery Easing -->
<script src="https://s-hmily.github.io/media/scripts/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://s-hmily.github.io/media/scripts/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://s-hmily.github.io/media/scripts/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://s-hmily.github.io/media/scripts/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://s-hmily.github.io/media/scripts/md5.min.js"></script>
<!-- katex -->
<!--<script src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js"></script>-->
<!-- highlight -->
<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>


<script type="application/javascript">
    // ä»£ç é«˜äº®
    hljs.initHighlightingOnLoad();

    // img æ‡’åŠ è½½
    $(function () {
        $("img.lazy").lazyload({
            effect: "fadeIn",  // æ‡’åŠ è½½åŠ¨ç”»
            threshold: 180  // åœ¨å›¾ç‰‡è·ç¦»å±å¹•180pxæ—¶æå‰è½½å…¥
        });
        // tooltip
        $('[data-toggle="tooltip"]').tooltip();

        // ç›®å½•
        $('#tool-toc').click(function () {
            $('.post-toc').toggle();
        });
    });

    
</script>




</body>
</html>
